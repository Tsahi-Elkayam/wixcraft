{
  "$schema": "../schema/rule.schema.json",
  "rules": [
    {
      "id": "service-requires-control",
      "name": "ServiceInstall should have ServiceControl",
      "description": "Services should have a ServiceControl element to manage start/stop/remove",
      "severity": "warning",
      "element": "ServiceInstall",
      "condition": "!hasSiblingServiceControl(attributes.Name)",
      "message": "ServiceInstall '{{attributes.Name}}' should have a matching ServiceControl element."
    },
    {
      "id": "service-account-warning",
      "name": "Review service account",
      "description": "Services running as LocalSystem have high privileges",
      "severity": "info",
      "element": "ServiceInstall",
      "condition": "!attributes.Account || attributes.Account === 'LocalSystem'",
      "message": "Service '{{attributes.Name}}' runs as LocalSystem. Consider using a less privileged account."
    },
    {
      "id": "service-start-type",
      "name": "Service Start type should be explicit",
      "description": "Explicitly set the Start type for clarity",
      "severity": "info",
      "element": "ServiceInstall",
      "condition": "!attributes.Start",
      "message": "ServiceInstall '{{attributes.Name}}' should have an explicit Start attribute (auto, demand, or disabled).",
      "fix": {
        "action": "addAttribute",
        "attribute": "Start",
        "value": "auto"
      }
    },
    {
      "id": "servicecontrol-wait",
      "name": "ServiceControl should wait for completion",
      "description": "Use Wait=\"yes\" to ensure service operations complete before continuing",
      "severity": "info",
      "element": "ServiceControl",
      "condition": "attributes.Wait !== 'yes' && (attributes.Stop || attributes.Remove)",
      "message": "Consider Wait=\"yes\" on ServiceControl '{{attributes.Id}}' to ensure the service stops before removal."
    },
    {
      "id": "service-description-recommended",
      "name": "Service should have Description",
      "description": "Services should have a description for administrators",
      "severity": "info",
      "element": "ServiceInstall",
      "condition": "!attributes.Description",
      "message": "Consider adding a Description to ServiceInstall '{{attributes.Name}}'."
    }
  ]
}

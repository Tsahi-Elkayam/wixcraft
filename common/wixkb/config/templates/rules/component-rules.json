{
  "$schema": "../schema/rule.schema.json",
  "rules": [
    {
      "id": "component-requires-guid",
      "name": "Component requires GUID",
      "description": "Every component must have a GUID unless it is transitive",
      "severity": "error",
      "element": "Component",
      "condition": "!attributes.Guid && attributes.Transitive !== 'yes'",
      "message": "Component '{{attributes.Id}}' must have a Guid attribute. Use Guid=\"*\" for auto-generation.",
      "fix": {
        "action": "addAttribute",
        "attribute": "Guid",
        "value": "*"
      }
    },
    {
      "id": "component-single-keypath",
      "name": "Component should have one key path",
      "description": "Each component should have exactly one key path resource",
      "severity": "warning",
      "element": "Component",
      "condition": "countKeyPaths() > 1",
      "message": "Component '{{attributes.Id}}' has multiple key paths. Only one resource should be marked as KeyPath=\"yes\"."
    },
    {
      "id": "component-one-file-recommended",
      "name": "One file per component recommended",
      "description": "Microsoft recommends one file per component for better upgrade behavior",
      "severity": "info",
      "element": "Component",
      "condition": "countChildren('File') > 1",
      "message": "Component '{{attributes.Id}}' has {{countChildren('File')}} files. Consider splitting into multiple components for better serviceability."
    },
    {
      "id": "component-guid-star",
      "name": "Use * for component GUID",
      "description": "Prefer Guid=\"*\" over hardcoded GUIDs for better maintainability",
      "severity": "info",
      "element": "Component",
      "condition": "attributes.Guid && attributes.Guid !== '*' && !isValidGuid(attributes.Guid)",
      "message": "Consider using Guid=\"*\" instead of hardcoding the GUID."
    }
  ]
}

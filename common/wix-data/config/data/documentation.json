{
  "_description": "WiX documentation, tutorials, and guides",
  "documentation": [
    {"id": "doc-intro-001", "category": "getting-started", "title": "WiX Toolset Introduction", "content": "WiX (Windows Installer XML) is a free toolset that builds Windows installation packages from XML source code. It supports MSI, MSM, MSP, and EXE bundles."},
    {"id": "doc-intro-002", "category": "getting-started", "title": "Installing WiX", "content": "Install WiX via .NET CLI: dotnet tool install --global wix. Or use NuGet package WixToolset.Sdk in your project."},
    {"id": "doc-intro-003", "category": "getting-started", "title": "First WiX Project", "content": "Create a .wixproj file, add .wxs source files, and build with 'dotnet build'. The output is an MSI installer."},
    {"id": "doc-intro-004", "category": "getting-started", "title": "WiX Project Structure", "content": "A WiX project consists of: .wixproj (project file), .wxs (source files), .wxi (include files), .wxl (localization), and optional extensions."},
    {"id": "doc-intro-005", "category": "getting-started", "title": "WiX v4 Changes", "content": "WiX v4 uses .NET SDK-style projects, simplified namespaces, Package element instead of Product, and StandardDirectory instead of directory references."},

    {"id": "doc-pkg-001", "category": "package", "title": "Package Element", "content": "The Package element defines the MSI package. Key attributes: Name, Manufacturer, Version, UpgradeCode. InstallerVersion should be 500 for v4 features."},
    {"id": "doc-pkg-002", "category": "package", "title": "UpgradeCode Best Practice", "content": "UpgradeCode is a GUID that identifies a product family. Keep it consistent across versions. Changing it breaks the upgrade path."},
    {"id": "doc-pkg-003", "category": "package", "title": "ProductCode vs UpgradeCode", "content": "ProductCode identifies a specific version and should change each release. UpgradeCode identifies the product family and should never change."},
    {"id": "doc-pkg-004", "category": "package", "title": "Version Numbering", "content": "Use Major.Minor.Build format. Windows Installer ignores the fourth field. Major upgrades change Major, minor upgrades change Minor."},
    {"id": "doc-pkg-005", "category": "package", "title": "Per-User vs Per-Machine", "content": "InstallScope='perMachine' requires elevation but installs for all users. InstallScope='perUser' doesn't require elevation but is user-specific."},

    {"id": "doc-comp-001", "category": "component", "title": "Component Rules", "content": "A Component is the atomic unit of installation. Rules: One component per file, stable GUID, single directory, KeyPath required."},
    {"id": "doc-comp-002", "category": "component", "title": "Component GUID", "content": "Use Guid='*' for auto-generation based on KeyPath. For permanent components, use an explicit stable GUID."},
    {"id": "doc-comp-003", "category": "component", "title": "KeyPath Explained", "content": "KeyPath is the resource used to detect if the component is installed. Can be a file (default), registry key, or ODBC data source."},
    {"id": "doc-comp-004", "category": "component", "title": "Component Condition", "content": "Component conditions control whether a component is installed. Use for optional features or platform-specific components."},
    {"id": "doc-comp-005", "category": "component", "title": "Permanent Components", "content": "Permanent='yes' means the component is never removed, even on uninstall. Requires a stable explicit GUID."},

    {"id": "doc-dir-001", "category": "directory", "title": "Directory Structure", "content": "Use StandardDirectory elements for common locations (ProgramFilesFolder, etc.). Directory elements create custom folders."},
    {"id": "doc-dir-002", "category": "directory", "title": "StandardDirectory", "content": "StandardDirectory provides predefined Windows folders: ProgramFilesFolder, ProgramFiles64Folder, CommonFilesFolder, etc."},
    {"id": "doc-dir-003", "category": "directory", "title": "TARGETDIR", "content": "TARGETDIR is the root of the installation directory tree. Usually set to the root of the target drive."},
    {"id": "doc-dir-004", "category": "directory", "title": "Creating Folders", "content": "Empty directories require CreateFolder element. Otherwise, the folder is only created when a file is installed to it."},
    {"id": "doc-dir-005", "category": "directory", "title": "Directory Properties", "content": "Directory names can include properties: [PropertyName]. These are resolved at install time."},

    {"id": "doc-file-001", "category": "file", "title": "File Element", "content": "File elements define files to install. Key attributes: Id, Source, KeyPath. Source points to the build location."},
    {"id": "doc-file-002", "category": "file", "title": "File Id Best Practice", "content": "File Ids should be meaningful and unique. For single-file components, use the same Id for Component and File."},
    {"id": "doc-file-003", "category": "file", "title": "Versioned Files", "content": "Files with version resources are tracked by version number. The installer uses file version for upgrade decisions."},
    {"id": "doc-file-004", "category": "file", "title": "File Compression", "content": "Files are compressed into CAB files by default. Use Compressed='no' for uncompressed files, or control via MediaTemplate."},
    {"id": "doc-file-005", "category": "file", "title": "Assembly Files", "content": "Assemblies can be installed to the GAC using Assembly='assembly' or to the application folder. .NET assemblies need special handling."},

    {"id": "doc-feat-001", "category": "feature", "title": "Feature Basics", "content": "Features group components for installation. Users can select features in Custom install. Features can be nested."},
    {"id": "doc-feat-002", "category": "feature", "title": "Feature Level", "content": "Level determines default install state. Level='1' is always installed. Level='0' is hidden/disabled. Higher levels require explicit selection."},
    {"id": "doc-feat-003", "category": "feature", "title": "Feature Display", "content": "Display attribute controls feature visibility: collapse (show collapsed), expand (show expanded), hidden (don't show)."},
    {"id": "doc-feat-004", "category": "feature", "title": "Feature Conditions", "content": "Use Condition element inside Feature to conditionally install features based on system state or user input."},
    {"id": "doc-feat-005", "category": "feature", "title": "ComponentRef", "content": "ComponentRef links a component to a feature. A component must be in at least one feature to be installed."},

    {"id": "doc-ca-001", "category": "customaction", "title": "Custom Action Types", "content": "Custom actions extend installer functionality. Types: DLL, EXE, VBScript, JScript, SetProperty, SetDirectory."},
    {"id": "doc-ca-002", "category": "customaction", "title": "Deferred Custom Actions", "content": "Deferred actions run during the execute sequence with elevated privileges. Use Execute='deferred' for system modifications."},
    {"id": "doc-ca-003", "category": "customaction", "title": "Immediate Custom Actions", "content": "Immediate actions run in the client process without elevation. Use for gathering data or setting properties."},
    {"id": "doc-ca-004", "category": "customaction", "title": "Rollback Custom Actions", "content": "Rollback actions undo changes if installation fails. Execute='rollback' runs before the paired deferred action."},
    {"id": "doc-ca-005", "category": "customaction", "title": "Custom Action Data", "content": "Deferred actions can't read session properties. Pass data via CustomActionData using SetProperty with same Id."},
    {"id": "doc-ca-006", "category": "customaction", "title": "Custom Action Sequencing", "content": "Schedule custom actions using Custom element in InstallExecuteSequence. Use Before/After attributes for ordering."},
    {"id": "doc-ca-007", "category": "customaction", "title": "DLL Custom Actions", "content": "DLL custom actions are most efficient. Entry point must be UINT __stdcall FunctionName(MSIHANDLE hInstall)."},
    {"id": "doc-ca-008", "category": "customaction", "title": "Script Custom Actions", "content": "VBScript/JScript actions are easier to write but slower and may be blocked by security policies."},

    {"id": "doc-reg-001", "category": "registry", "title": "Registry Basics", "content": "RegistryKey creates registry keys. RegistryValue creates values. Root attribute specifies hive: HKLM, HKCU, HKCR, HKU, HKMU."},
    {"id": "doc-reg-002", "category": "registry", "title": "Registry Types", "content": "Value types: string (REG_SZ), expandable (REG_EXPAND_SZ), integer (REG_DWORD), binary (REG_BINARY), multiString (REG_MULTI_SZ)."},
    {"id": "doc-reg-003", "category": "registry", "title": "HKMU Registry", "content": "HKMU writes to HKLM for per-machine installs and HKCU for per-user installs. Useful for dual-purpose packages."},
    {"id": "doc-reg-004", "category": "registry", "title": "Registry KeyPath", "content": "Use KeyPath='yes' on a registry value to make it the component's KeyPath. Good for registry-only components."},
    {"id": "doc-reg-005", "category": "registry", "title": "Registry Permissions", "content": "Use PermissionEx from util extension to set ACLs on registry keys. Be careful with permissions."},

    {"id": "doc-svc-001", "category": "service", "title": "ServiceInstall", "content": "ServiceInstall registers a Windows service. Requires Name, Start type (auto, demand, disabled), Type (ownProcess, shareProcess), ErrorControl."},
    {"id": "doc-svc-002", "category": "service", "title": "ServiceControl", "content": "ServiceControl starts, stops, or deletes services during install/uninstall. Use Wait='yes' to wait for service to stop."},
    {"id": "doc-svc-003", "category": "service", "title": "Service Account", "content": "Account attribute specifies the service account. Use LocalSystem, LocalService, NetworkService, or a specific account."},
    {"id": "doc-svc-004", "category": "service", "title": "Service Dependencies", "content": "ServiceDependency specifies services that must start before this service. Can depend on service names or groups."},
    {"id": "doc-svc-005", "category": "service", "title": "Service Recovery", "content": "Use util:ServiceConfig for service recovery options. Specify actions on first, second, and subsequent failures."},

    {"id": "doc-shrt-001", "category": "shortcut", "title": "Shortcut Basics", "content": "Shortcut creates Start Menu or Desktop shortcuts. Must be in a component with a file in the same directory or use Advertise='yes'."},
    {"id": "doc-shrt-002", "category": "shortcut", "title": "Advertised Shortcuts", "content": "Advertised shortcuts (Advertise='yes') enable repair and install-on-demand. They don't require a file in the same directory."},
    {"id": "doc-shrt-003", "category": "shortcut", "title": "Shortcut Icon", "content": "Use Icon attribute to specify shortcut icon. Can be an Icon element Id or the target file's icon."},
    {"id": "doc-shrt-004", "category": "shortcut", "title": "Shortcut Arguments", "content": "Use Arguments attribute to pass command-line arguments to the shortcut target."},
    {"id": "doc-shrt-005", "category": "shortcut", "title": "Working Directory", "content": "WorkingDirectory attribute sets the shortcut's start-in directory. Reference a Directory element Id."},

    {"id": "doc-upg-001", "category": "upgrade", "title": "MajorUpgrade", "content": "MajorUpgrade handles major version upgrades automatically. Removes previous version and installs new. Use DowngradeErrorMessage for downgrade prevention."},
    {"id": "doc-upg-002", "category": "upgrade", "title": "Upgrade Table", "content": "For complex upgrade scenarios, use Upgrade element with UpgradeVersion children to detect specific versions."},
    {"id": "doc-upg-003", "category": "upgrade", "title": "Minor Upgrades", "content": "Minor upgrades (same ProductCode, new version) are installed via msiexec /i with REINSTALLMODE=vomus REINSTALL=ALL."},
    {"id": "doc-upg-004", "category": "upgrade", "title": "Patch Creation", "content": "Patches (.msp) contain only changed files. Create with wix.exe using PatchCreation element or wix msp command."},
    {"id": "doc-upg-005", "category": "upgrade", "title": "Version Comparison", "content": "Windows Installer compares versions as Major.Minor.Build integers. Version 2.0.0 > 1.99.0 but 1.0.0 < 1.0.1."},

    {"id": "doc-ui-001", "category": "ui", "title": "WixUI Dialogs", "content": "Use WixUI extension for standard dialog sets: WixUI_Minimal, WixUI_InstallDir, WixUI_FeatureTree, WixUI_Mondo, WixUI_Advanced."},
    {"id": "doc-ui-002", "category": "ui", "title": "Custom UI", "content": "Create custom dialogs with Dialog element containing Control elements. Use Publish for button actions."},
    {"id": "doc-ui-003", "category": "ui", "title": "UI Levels", "content": "UILevel property controls installation UI: 2=none, 3=basic, 4=reduced, 5=full. Silent installs use level 2 or 3."},
    {"id": "doc-ui-004", "category": "ui", "title": "Dialog Customization", "content": "Customize WixUI dialogs by copying the dialog definition and modifying it. Use UIRef to reference the modified version."},
    {"id": "doc-ui-005", "category": "ui", "title": "Localization", "content": "Use .wxl files for localized strings. Reference with !(loc.StringId) syntax. Build with -culture option."},

    {"id": "doc-bndl-001", "category": "bundle", "title": "Bundle Basics", "content": "Burn bundles combine multiple installers into a single EXE. Chain MSI, EXE, MSU, and MSP packages together."},
    {"id": "doc-bndl-002", "category": "bundle", "title": "Chain Element", "content": "Chain contains the packages to install. Order matters - packages install in sequence. Use RollbackBoundary for transaction control."},
    {"id": "doc-bndl-003", "category": "bundle", "title": "MsiPackage", "content": "MsiPackage references an MSI installer in the bundle. Use DisplayInternalUI='yes' to show the MSI's UI."},
    {"id": "doc-bndl-004", "category": "bundle", "title": "ExePackage", "content": "ExePackage references an EXE installer. Requires DetectCondition, InstallCommand, and UninstallCommand."},
    {"id": "doc-bndl-005", "category": "bundle", "title": "Bundle Variables", "content": "Variable elements define bundle variables. Use in conditions and command lines. WixBundleLog contains log path."},
    {"id": "doc-bndl-006", "category": "bundle", "title": "Bootstrapper Application", "content": "BootstrapperApplication controls the bundle UI. Use WixStandardBootstrapperApplication for default UI or create custom BA."},
    {"id": "doc-bndl-007", "category": "bundle", "title": "Payload", "content": "Payload elements define files to include in the bundle. Can be embedded or external with download URL."},
    {"id": "doc-bndl-008", "category": "bundle", "title": "DetectCondition", "content": "DetectCondition determines if a package is already installed. Use registry searches or version checks."},

    {"id": "doc-ext-iis-001", "category": "extension-iis", "title": "IIS Extension", "content": "WixToolset.Iis.wixext adds IIS configuration support. Create websites, app pools, virtual directories."},
    {"id": "doc-ext-iis-002", "category": "extension-iis", "title": "WebSite Element", "content": "WebSite creates an IIS website. Requires Id, Description, Directory. Add WebAddress for bindings."},
    {"id": "doc-ext-iis-003", "category": "extension-iis", "title": "WebAppPool", "content": "WebAppPool creates an application pool. Configure identity, recycling, and process model."},
    {"id": "doc-ext-iis-004", "category": "extension-iis", "title": "WebApplication", "content": "WebApplication creates an IIS application within a site. Reference an AppPool."},
    {"id": "doc-ext-iis-005", "category": "extension-iis", "title": "WebVirtualDir", "content": "WebVirtualDir creates a virtual directory mapping a URL path to a physical directory."},

    {"id": "doc-ext-sql-001", "category": "extension-sql", "title": "SQL Extension", "content": "WixToolset.Sql.wixext manages SQL Server databases. Create databases, run scripts, manage users."},
    {"id": "doc-ext-sql-002", "category": "extension-sql", "title": "SqlDatabase", "content": "SqlDatabase creates or connects to a database. Specify Server, Database name, and authentication."},
    {"id": "doc-ext-sql-003", "category": "extension-sql", "title": "SqlScript", "content": "SqlScript runs a SQL script file. Use ExecuteOnInstall, ExecuteOnUninstall to control execution."},
    {"id": "doc-ext-sql-004", "category": "extension-sql", "title": "SqlString", "content": "SqlString executes an inline SQL statement. Good for simple operations."},

    {"id": "doc-ext-util-001", "category": "extension-util", "title": "Util Extension", "content": "WixToolset.Util.wixext provides utility elements for users, permissions, XML files, and more."},
    {"id": "doc-ext-util-002", "category": "extension-util", "title": "User Element", "content": "User creates Windows user accounts. Specify Name, Password, and group membership."},
    {"id": "doc-ext-util-003", "category": "extension-util", "title": "PermissionEx", "content": "PermissionEx sets ACLs on files, directories, or registry keys. More powerful than Permission."},
    {"id": "doc-ext-util-004", "category": "extension-util", "title": "XmlFile", "content": "XmlFile modifies XML configuration files. Use Action='setValue' to set element values."},
    {"id": "doc-ext-util-005", "category": "extension-util", "title": "CloseApplication", "content": "CloseApplication prompts to close running applications before installation."},
    {"id": "doc-ext-util-006", "category": "extension-util", "title": "RemoveFolderEx", "content": "RemoveFolderEx removes folders including all contents on uninstall. More powerful than RemoveFolder."},
    {"id": "doc-ext-util-007", "category": "extension-util", "title": "ServiceConfig", "content": "ServiceConfig sets service failure actions and recovery options."},
    {"id": "doc-ext-util-008", "category": "extension-util", "title": "RegistrySearch", "content": "RegistrySearch reads registry values into properties. Use in AppSearch for detection."},

    {"id": "doc-ext-netfx-001", "category": "extension-netfx", "title": "NetFx Extension", "content": "WixToolset.Netfx.wixext supports .NET Framework detection and prerequisites."},
    {"id": "doc-ext-netfx-002", "category": "extension-netfx", "title": "DotNetCoreSearch", "content": "DotNetCoreSearch detects .NET Core/5+ runtime versions. Set property with detected version."},
    {"id": "doc-ext-netfx-003", "category": "extension-netfx", "title": "NativeImage", "content": "NativeImage generates NGEN images for .NET assemblies at install time."},

    {"id": "doc-ext-bal-001", "category": "extension-bal", "title": "Bal Extension", "content": "WixToolset.Bal.wixext provides bootstrapper application support and UI elements."},
    {"id": "doc-ext-bal-002", "category": "extension-bal", "title": "WixStandardBootstrapperApplication", "content": "Standard BA provides HyperlinkLicense, RtfLicense, or HyperlinkSidebarLicense themes."},
    {"id": "doc-ext-bal-003", "category": "extension-bal", "title": "Overridable Variables", "content": "Use bal:Overridable='yes' on Variable to allow command-line override."},

    {"id": "doc-ext-fire-001", "category": "extension-firewall", "title": "Firewall Extension", "content": "WixToolset.Firewall.wixext manages Windows Firewall rules."},
    {"id": "doc-ext-fire-002", "category": "extension-firewall", "title": "FirewallException", "content": "FirewallException creates inbound firewall rules. Specify Port, Protocol, and Program."},

    {"id": "doc-bp-001", "category": "best-practice", "title": "One File Per Component", "content": "Each component should contain only one file. This enables proper repair, patching, and reference counting."},
    {"id": "doc-bp-002", "category": "best-practice", "title": "Stable Component GUIDs", "content": "Component GUIDs should remain stable across versions. Changing them breaks upgrade reference counting."},
    {"id": "doc-bp-003", "category": "best-practice", "title": "Use Auto-GUID", "content": "Use Guid='*' for automatic GUID generation based on install path and KeyPath. Ensures stability."},
    {"id": "doc-bp-004", "category": "best-practice", "title": "Always Include MajorUpgrade", "content": "Every installer should have MajorUpgrade to handle version upgrades and prevent downgrades."},
    {"id": "doc-bp-005", "category": "best-practice", "title": "Sign Your Installer", "content": "Digitally sign MSI packages and bundles. Prevents SmartScreen warnings and verifies authenticity."},
    {"id": "doc-bp-006", "category": "best-practice", "title": "Test Silent Installation", "content": "Test with msiexec /qn to verify silent installation works. Important for enterprise deployment."},
    {"id": "doc-bp-007", "category": "best-practice", "title": "Use Conditions Sparingly", "content": "Complex conditions make testing difficult. Prefer feature selection over conditional components."},
    {"id": "doc-bp-008", "category": "best-practice", "title": "Clean Uninstall", "content": "Test uninstall thoroughly. Use RemoveFile and RemoveFolder for non-installed files."},
    {"id": "doc-bp-009", "category": "best-practice", "title": "Minimize Custom Actions", "content": "Custom actions add complexity and failure points. Use built-in MSI functionality when possible."},
    {"id": "doc-bp-010", "category": "best-practice", "title": "Log Everything", "content": "Use MsiLogging property for detailed logs. Essential for troubleshooting installation issues."},

    {"id": "doc-ts-001", "category": "troubleshooting", "title": "Enable Logging", "content": "Enable MSI logging: msiexec /i package.msi /l*v install.log. The log file shows all actions and errors."},
    {"id": "doc-ts-002", "category": "troubleshooting", "title": "Common Error 1603", "content": "Error 1603 is a generic fatal error. Check the log for the actual cause - often custom action or permission issues."},
    {"id": "doc-ts-003", "category": "troubleshooting", "title": "ICE Validation", "content": "Run ICE validation: wix.exe validate package.msi. ICE errors indicate authoring problems."},
    {"id": "doc-ts-004", "category": "troubleshooting", "title": "Repair Not Working", "content": "Repair issues often stem from incorrect KeyPath or changed component GUIDs. Verify component rules."},
    {"id": "doc-ts-005", "category": "troubleshooting", "title": "Upgrade Not Removing Old Version", "content": "Check UpgradeCode matches, version comparison works, and MajorUpgrade is properly configured."},

    {"id": "doc-ref-001", "category": "reference", "title": "MSI Command Line", "content": "msiexec options: /i install, /x uninstall, /f repair, /a admin install, /q quiet modes, /l logging."},
    {"id": "doc-ref-002", "category": "reference", "title": "Property Reference", "content": "Key properties: TARGETDIR, INSTALLDIR, VersionNT, Installed, REMOVE, ADDLOCAL, UILevel."},
    {"id": "doc-ref-003", "category": "reference", "title": "Condition Syntax", "content": "Conditions: PropertyName (true if set), PropertyName='value', AND/OR/NOT operators, comparison operators."},
    {"id": "doc-ref-004", "category": "reference", "title": "Preprocessor Variables", "content": "Preprocessor: $(var.Name), $(env.ENVVAR), $(sys.CURRENTDIR), !(loc.StringId) for localization."},
    {"id": "doc-ref-005", "category": "reference", "title": "WiX CLI Reference", "content": "wix build: compile and link. wix extension: manage extensions. wix convert: convert v3 to v4."}
  ]
}

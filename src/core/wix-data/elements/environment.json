{
  "$schema": "../schema/element.schema.json",
  "name": "Environment",
  "namespace": "wix",
  "since": "v3",
  "description": "Creates, modifies, or removes environment variables.",
  "documentation": "https://wixtoolset.org/docs/schema/wxs/environment/",
  "parents": ["Component"],
  "children": [],
  "attributes": {
    "Id": {
      "type": "identifier",
      "required": true,
      "description": "Unique identifier for the environment variable."
    },
    "Name": {
      "type": "string",
      "required": true,
      "description": "Name of the environment variable."
    },
    "Value": {
      "type": "string",
      "required": false,
      "description": "Value to set for the environment variable."
    },
    "Action": {
      "type": "enum",
      "required": false,
      "values": ["create", "set", "remove"],
      "default": "set",
      "description": "Action to perform on the environment variable."
    },
    "Part": {
      "type": "enum",
      "required": false,
      "values": ["all", "first", "last"],
      "default": "all",
      "description": "Which part of the variable to modify."
    },
    "Permanent": {
      "type": "yesno",
      "required": false,
      "default": "no",
      "description": "Whether to leave the variable on uninstall."
    },
    "System": {
      "type": "yesno",
      "required": false,
      "default": "no",
      "description": "Whether this is a system variable (vs user variable)."
    },
    "Separator": {
      "type": "string",
      "required": false,
      "default": ";",
      "description": "Separator character for PATH-style variables."
    }
  },
  "msiTables": ["Environment"],
  "examples": [
    {
      "description": "Add to PATH",
      "code": "<Environment Id=\"PathEnv\" Name=\"PATH\" Value=\"[INSTALLFOLDER]\" Action=\"set\" Part=\"last\" Separator=\";\" System=\"yes\" />"
    }
  ]
}

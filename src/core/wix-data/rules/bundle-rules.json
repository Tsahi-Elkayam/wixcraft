{
  "$schema": "../schema/rule.schema.json",
  "rules": [
    {
      "id": "bundle-requires-upgradecode",
      "name": "Bundle requires UpgradeCode",
      "description": "Bundles must have an UpgradeCode for proper upgrade detection",
      "severity": "error",
      "element": "Bundle",
      "condition": "!attributes.UpgradeCode",
      "message": "Bundle must have an UpgradeCode attribute for upgrade support."
    },
    {
      "id": "bundle-requires-version",
      "name": "Bundle requires Version",
      "description": "Bundles must have a Version for upgrade comparison",
      "severity": "error",
      "element": "Bundle",
      "condition": "!attributes.Version",
      "message": "Bundle must have a Version attribute."
    },
    {
      "id": "chain-not-empty",
      "name": "Chain should not be empty",
      "description": "Bundle Chain should contain at least one package",
      "severity": "error",
      "element": "Chain",
      "condition": "countChildren() === 0",
      "message": "Bundle Chain is empty. Add at least one package (MsiPackage, ExePackage, etc.)."
    },
    {
      "id": "msipackage-vital",
      "name": "Consider Vital attribute on MsiPackage",
      "description": "Vital packages stop the chain on failure",
      "severity": "info",
      "element": "MsiPackage",
      "condition": "!attributes.Vital",
      "message": "Consider adding Vital=\"yes\" or \"no\" to MsiPackage '{{attributes.Id}}' to control chain behavior on failure."
    },
    {
      "id": "exepackage-detect-condition",
      "name": "ExePackage should have DetectCondition",
      "description": "ExePackages need DetectCondition to determine if already installed",
      "severity": "warning",
      "element": "ExePackage",
      "condition": "!attributes.DetectCondition && !attributes.DetectConditionRef",
      "message": "ExePackage '{{attributes.Id}}' should have a DetectCondition to check if it's already installed."
    },
    {
      "id": "exepackage-uninstall-command",
      "name": "ExePackage should have UninstallCommand",
      "description": "ExePackages need UninstallCommand for proper uninstallation",
      "severity": "warning",
      "element": "ExePackage",
      "condition": "!attributes.UninstallCommand",
      "message": "ExePackage '{{attributes.Id}}' should have an UninstallCommand for clean uninstallation."
    }
  ]
}

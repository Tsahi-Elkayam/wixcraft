{
  "$schema": "../schema/rule.schema.json",
  "rules": [
    {
      "id": "package-requires-upgradecode",
      "name": "Package requires UpgradeCode",
      "description": "Packages must have an UpgradeCode for proper major upgrade support",
      "severity": "error",
      "element": "Package",
      "condition": "!attributes.UpgradeCode",
      "message": "Package must have an UpgradeCode for upgrade support. Generate a new GUID and keep it constant across versions."
    },
    {
      "id": "package-requires-version",
      "name": "Package requires Version",
      "description": "Packages must have a Version for upgrade comparison",
      "severity": "error",
      "element": "Package",
      "condition": "!attributes.Version",
      "message": "Package must have a Version attribute in X.X.X.X format."
    },
    {
      "id": "package-requires-manufacturer",
      "name": "Package requires Manufacturer",
      "description": "Packages must have a Manufacturer for Add/Remove Programs",
      "severity": "error",
      "element": "Package",
      "condition": "!attributes.Manufacturer",
      "message": "Package must have a Manufacturer attribute."
    },
    {
      "id": "package-requires-name",
      "name": "Package requires Name",
      "description": "Packages must have a Name for Add/Remove Programs",
      "severity": "error",
      "element": "Package",
      "condition": "!attributes.Name",
      "message": "Package must have a Name attribute."
    },
    {
      "id": "package-majorupgrade-recommended",
      "name": "Package should have MajorUpgrade",
      "description": "Most packages should define MajorUpgrade behavior",
      "severity": "warning",
      "element": "Package",
      "condition": "!hasChild('MajorUpgrade') && !hasChild('Upgrade')",
      "message": "Consider adding a MajorUpgrade element to handle upgrades gracefully."
    },
    {
      "id": "package-mediatemplate-recommended",
      "name": "Package should have MediaTemplate",
      "description": "MediaTemplate is recommended for cabinet handling",
      "severity": "info",
      "element": "Package",
      "condition": "!hasChild('MediaTemplate') && !hasChild('Media')",
      "message": "Consider adding <MediaTemplate EmbedCab=\"yes\" /> for embedded cabinet files."
    },
    {
      "id": "package-compressed-recommended",
      "name": "Package should compress files",
      "description": "Compressed packages are smaller and download faster",
      "severity": "info",
      "element": "Package",
      "condition": "attributes.Compressed !== 'yes'",
      "message": "Consider Compressed=\"yes\" to reduce package size.",
      "fix": {
        "action": "addAttribute",
        "attribute": "Compressed",
        "value": "yes"
      }
    }
  ]
}

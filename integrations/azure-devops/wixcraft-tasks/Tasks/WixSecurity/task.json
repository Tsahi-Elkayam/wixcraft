{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
  "name": "WixSecurity",
  "friendlyName": "WiX Security Scan",
  "description": "Scan WiX source files for privilege escalation and security vulnerabilities",
  "helpMarkDown": "[Learn more](https://github.com/wixcraft/wixcraft)",
  "category": "Build",
  "visibility": ["Build", "Release"],
  "author": "WixCraft",
  "version": {
    "Major": 0,
    "Minor": 1,
    "Patch": 0
  },
  "instanceNameFormat": "WiX Security Scan $(files)",
  "groups": [
    {
      "name": "thresholds",
      "displayName": "Severity Thresholds",
      "isExpanded": true
    },
    {
      "name": "output",
      "displayName": "Output Options",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "files",
      "type": "filePath",
      "label": "WiX Files",
      "defaultValue": "**/*.wxs",
      "required": true,
      "helpMarkDown": "Glob pattern for WiX files to scan"
    },
    {
      "name": "failOnSeverity",
      "type": "pickList",
      "label": "Fail on Severity",
      "defaultValue": "high",
      "options": {
        "critical": "Critical only",
        "high": "High and above",
        "medium": "Medium and above",
        "low": "Low and above",
        "info": "All findings"
      },
      "groupName": "thresholds",
      "helpMarkDown": "Minimum severity to fail the build"
    },
    {
      "name": "minSeverity",
      "type": "pickList",
      "label": "Report Minimum Severity",
      "defaultValue": "low",
      "options": {
        "critical": "Critical only",
        "high": "High and above",
        "medium": "Medium and above",
        "low": "Low and above",
        "info": "All findings"
      },
      "groupName": "thresholds",
      "helpMarkDown": "Minimum severity to include in report"
    },
    {
      "name": "outputFormat",
      "type": "pickList",
      "label": "Output Format",
      "defaultValue": "text",
      "options": {
        "text": "Text",
        "json": "JSON",
        "sarif": "SARIF"
      },
      "groupName": "output",
      "helpMarkDown": "Output format for results"
    },
    {
      "name": "sarifOutput",
      "type": "filePath",
      "label": "SARIF Output File",
      "defaultValue": "$(Build.ArtifactStagingDirectory)/wix-security.sarif",
      "required": false,
      "groupName": "output",
      "helpMarkDown": "Path to write SARIF output for GitHub Advanced Security integration"
    }
  ],
  "execution": {
    "PowerShell3": {
      "target": "wix-security.ps1"
    }
  }
}

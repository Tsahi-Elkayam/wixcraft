{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "c3d4e5f6-a7b8-9012-cdef-123456789012",
  "name": "WixUpgrade",
  "friendlyName": "WiX Upgrade Validator",
  "description": "Validate WiX project upgrade readiness and compare versions for compatibility",
  "helpMarkDown": "[Learn more](https://github.com/wixcraft/wixcraft)",
  "category": "Build",
  "visibility": ["Build", "Release"],
  "author": "WixCraft",
  "version": {
    "Major": 0,
    "Minor": 1,
    "Patch": 0
  },
  "instanceNameFormat": "WiX Upgrade Validation",
  "groups": [
    {
      "name": "comparison",
      "displayName": "Version Comparison",
      "isExpanded": false
    },
    {
      "name": "output",
      "displayName": "Output Options",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "files",
      "type": "filePath",
      "label": "WiX Files",
      "defaultValue": "**/*.wxs",
      "required": true,
      "helpMarkDown": "Glob pattern for WiX files to validate"
    },
    {
      "name": "failOnSeverity",
      "type": "pickList",
      "label": "Fail on Severity",
      "defaultValue": "error",
      "options": {
        "error": "Errors only",
        "warning": "Warnings and above",
        "info": "All issues"
      },
      "helpMarkDown": "Minimum severity to fail the build"
    },
    {
      "name": "enableComparison",
      "type": "boolean",
      "label": "Enable Version Comparison",
      "defaultValue": "false",
      "groupName": "comparison",
      "helpMarkDown": "Compare current version against a baseline"
    },
    {
      "name": "baselineFiles",
      "type": "filePath",
      "label": "Baseline WiX Files",
      "defaultValue": "",
      "required": false,
      "groupName": "comparison",
      "visibleRule": "enableComparison = true",
      "helpMarkDown": "Previous version WiX files to compare against"
    },
    {
      "name": "baselineBranch",
      "type": "string",
      "label": "Baseline Branch",
      "defaultValue": "main",
      "required": false,
      "groupName": "comparison",
      "visibleRule": "enableComparison = true",
      "helpMarkDown": "Git branch to use as baseline (fetches WiX files from that branch)"
    },
    {
      "name": "outputFormat",
      "type": "pickList",
      "label": "Output Format",
      "defaultValue": "text",
      "options": {
        "text": "Text",
        "json": "JSON"
      },
      "groupName": "output",
      "helpMarkDown": "Output format for results"
    }
  ],
  "execution": {
    "PowerShell3": {
      "target": "wix-upgrade.ps1"
    }
  }
}
